<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hotel Booking Calendar</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales-all.min.js"></script>
</head>
<body>
    <h2 class="text-center my-4">Hotel Booking Calendar</h2>
    <div id="calendar"></div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            let calendarEl = document.getElementById("calendar");
            let calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: "dayGridMonth",
                selectable: true,
                eventClick: function(info) {
                    alert("Booking: " + info.event.title);
                },
                dateClick: function(info) {
                    let room = prompt("Enter room number to book:");
                    if (room) {
                        let checkin = info.dateStr;
                        let checkout = prompt("Enter checkout date (YYYY-MM-DD):");
                        let customer = prompt("Enter customer name:");

                        fetch("/book", {
                            method: "POST",
                            body: new URLSearchParams({
                                room: room,
                                checkin: checkin,
                                checkout: checkout,
                                customer: customer,
                                phone: "0000000000",  // ป้องกันค่า null
                                payment: "Cash",
                            })
                        })
                        .then(response => response.json())
                        .then(data => {
                            alert(data.message);
                            calendar.refetchEvents();
                        });
                    }
                },
                events: "/get_bookings"
            });
            calendar.render();
        });
    </script>
</body>
</html>
